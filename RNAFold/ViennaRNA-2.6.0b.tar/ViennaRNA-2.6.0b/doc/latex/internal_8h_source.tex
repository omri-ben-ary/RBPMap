\hypertarget{internal_8h_source}{}\doxysection{internal.\+h}
\label{internal_8h_source}\index{ViennaRNA/loops/internal.h@{ViennaRNA/loops/internal.h}}
\mbox{\hyperlink{internal_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ VIENNA\_RNA\_PACKAGE\_LOOPS\_INTERNAL\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ VIENNA\_RNA\_PACKAGE\_LOOPS\_INTERNAL\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <math.h>}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{utils_2basic_8h}{ViennaRNA/utils/basic.h}}>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <ViennaRNA/params/default.h>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{datastructures_2basic_8h}{ViennaRNA/datastructures/basic.h}}>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{fold__compound_8h}{ViennaRNA/fold\_compound.h}}>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{params_2basic_8h}{ViennaRNA/params/basic.h}}>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{hard_8h}{ViennaRNA/constraints/hard.h}}>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{soft_8h}{ViennaRNA/constraints/soft.h}}>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{salt_8h}{ViennaRNA/params/salt.h}}>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#ifdef\ VRNA\_WARN\_DEPRECATED}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#\ if\ defined(DEPRECATED)}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#\ \ \ undef\ DEPRECATED}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#\ if\ defined(\_\_clang\_\_)}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#\ \ define\ DEPRECATED(func,\ msg)\ func\ \_\_attribute\_\_\ ((deprecated("{}"{}},\ msg)))}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#\ elif\ defined(\_\_GNUC\_\_)}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#\ \ define\ DEPRECATED(func,\ msg)\ func\ \_\_attribute\_\_\ ((deprecated(msg)))}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#\ else}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#\ \ define\ DEPRECATED(func,\ msg)\ func}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#\ define\ DEPRECATED(func,\ msg)\ func}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#ifdef\ \_\_GNUC\_\_}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#\ define\ INLINE\ inline}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#\ define\ INLINE}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00053\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00054\ vrna\_E\_int\_loop(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}\ \ *fc,}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j);}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00066\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00067\ \mbox{\hyperlink{group__eval__loops__int_gaab3547bfcdc39d89babbc7ed2a1a4b65}{vrna\_eval\_int\_loop}}(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}\ *fc,}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j,}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ k,}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00075\ vrna\_E\_ext\_int\_loop(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}\ \ *fc,}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j,}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *ip,}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *iq);}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00083\ vrna\_E\_stack(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}\ *fc,}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{comment}{/*\ End\ basic\ interface\ */}}
\DoxyCodeLine{00098\ \textcolor{comment}{/*\ j\ <\ i\ indicates\ circular\ folding,\ i.e.\ collect\ contributions\ for\ exterior\ int\ loops\ */}}
\DoxyCodeLine{00099\ \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}}
\DoxyCodeLine{00100\ vrna\_exp\_E\_int\_loop(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}\ \ *fc,}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}}
\DoxyCodeLine{00106\ vrna\_exp\_E\_interior\_loop(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}\ *fc,}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j,}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ k,}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l);}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{comment}{/*\ End\ partition\ function\ interface\ */}}
\DoxyCodeLine{00131\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00132\ \mbox{\hyperlink{group__mfe__backtracking_ga28015cfbd0afc759b94ff58cc241cb13}{vrna\_BT\_stack}}(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}\ \ *fc,}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *i,}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *j,}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *en,}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}}\ \ \ \ \ \ \ *bp\_stack,}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *stack\_count);}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00144\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00145\ \mbox{\hyperlink{group__mfe__backtracking_ga90b5a5723173996fb40640ce7c95c07e}{vrna\_BT\_int\_loop}}(\mbox{\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}}\ *fc,}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *i,}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *j,}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ en,}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}}\ \ \ \ \ \ *bp\_stack,}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *stack\_count);}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00158\ \textcolor{preprocessor}{\#ifndef\ VRNA\_DISABLE\_BACKWARD\_COMPATIBILITY}}
\DoxyCodeLine{00165\ \textcolor{preprocessor}{\#ifdef\ ON\_SAME\_STRAND}}
\DoxyCodeLine{00166\ \textcolor{preprocessor}{\#undef\ ON\_SAME\_STRAND}}
\DoxyCodeLine{00167\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\#define\ ON\_SAME\_STRAND(I,\ J,\ C)\ \ (((I)\ >=\ (C))\ ||\ ((J)\ <\ (C)))}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00215\ PRIVATE\ INLINE\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{group__eval__deprecated_gaafbc187b7f78e8e82afb77dd6f3b8fc5}{E\_IntLoop}}(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ n1,}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ n2,}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ type,}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ type\_2,}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ si1,}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ sj1,}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ sp1,}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ sq1,}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}\ *P);}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00245\ PRIVATE\ INLINE\ \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}\ \mbox{\hyperlink{group__eval__deprecated_ga95de54d8a2a17645a95e0f34e189d9c9}{exp\_E\_IntLoop}}(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u1,}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u2,}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ type,}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ type2,}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ \ \ \ si1,}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ \ \ \ sj1,}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ \ \ \ sp1,}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ \ \ \ sq1,}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}}\ \ *P);}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ PRIVATE\ INLINE\ \textcolor{keywordtype}{int}\ E\_IntLoop\_Co(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ type,}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ type\_2,}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ j,}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ p,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ q,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ cutpoint,}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ si1,}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sj1,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sp1,}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sq1,}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}},}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}\ \ *P);}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \textcolor{comment}{/*}}
\DoxyCodeLine{00272\ \textcolor{comment}{\ *\ \ ugly\ but\ fast\ interior\ loop\ evaluation}}
\DoxyCodeLine{00273\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00274\ \textcolor{comment}{\ *\ \ Avoid\ including\ this\ function\ in\ your\ own\ code.\ It\ only\ serves}}
\DoxyCodeLine{00275\ \textcolor{comment}{\ *\ \ as\ a\ fast\ inline\ block\ internally\ re-\/used\ throughout\ the\ RNAlib.\ It}}
\DoxyCodeLine{00276\ \textcolor{comment}{\ *\ \ evalutes\ the\ free\ energy\ of\ interior\ loops\ in\ single\ sequences\ or\ sequence}}
\DoxyCodeLine{00277\ \textcolor{comment}{\ *\ \ hybrids.\ Soft\ constraints\ are\ also\ applied\ if\ available.}}
\DoxyCodeLine{00278\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00279\ \textcolor{comment}{\ *\ \ NOTE:\ do\ not\ include\ into\ doxygen\ reference\ manual!}}
\DoxyCodeLine{00280\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00281\ PRIVATE\ INLINE\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00282\ ubf\_eval\_int\_loop(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ j,}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ p,}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ q,}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ i1,}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ j1,}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ p1,}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ q1,}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ si,}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sj,}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sp,}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sq,}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ type,}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ type\_2,}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ *rtype,}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ ij,}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ cp,}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}\ \ *P,}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__soft__constraints_structvrna__sc__s}{vrna\_sc\_t}}\ \ \ \ \ *sc)}
\DoxyCodeLine{00301\ \{}
\DoxyCodeLine{00302\ \ \ \textcolor{keywordtype}{int}\ energy,\ u1,\ u2;}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ u1\ \ =\ p1\ -\/\ i;}
\DoxyCodeLine{00305\ \ \ u2\ \ =\ j1\ -\/\ q;}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \textcolor{keywordflow}{if}\ ((cp\ <\ 0)\ ||\ (ON\_SAME\_STRAND(i,\ p,\ cp)\ \&\&\ ON\_SAME\_STRAND(q,\ j,\ cp)))\ \{}
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{comment}{/*\ regular\ interior\ loop\ */}}
\DoxyCodeLine{00309\ \ \ \ \ energy\ =\ \mbox{\hyperlink{group__eval__deprecated_gaafbc187b7f78e8e82afb77dd6f3b8fc5}{E\_IntLoop}}(u1,\ u2,\ type,\ type\_2,\ si,\ sj,\ sp,\ sq,\ P);}
\DoxyCodeLine{00310\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{comment}{/*\ interior\ loop\ like\ cofold\ structure\ */}}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keywordtype}{short}\ Si,\ Sj;}
\DoxyCodeLine{00313\ \ \ \ \ Si\ \ \ \ \ \ =\ ON\_SAME\_STRAND(i,\ i1,\ cp)\ ?\ si\ :\ -\/1;}
\DoxyCodeLine{00314\ \ \ \ \ Sj\ \ \ \ \ \ =\ ON\_SAME\_STRAND(j1,\ j,\ cp)\ ?\ sj\ :\ -\/1;}
\DoxyCodeLine{00315\ \ \ \ \ energy\ \ =\ E\_IntLoop\_Co(rtype[type],\ rtype[type\_2],}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,\ j,\ p,\ q,}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cp,}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Si,\ Sj,}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sp,\ sq,}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}},}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P);}
\DoxyCodeLine{00322\ \ \ \}}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \ \ \textcolor{comment}{/*\ add\ soft\ constraints\ */}}
\DoxyCodeLine{00325\ \ \ \textcolor{keywordflow}{if}\ (sc)\ \{}
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}})}
\DoxyCodeLine{00327\ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}}[i1][u1]}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}}[q1][u2];}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_ad139b8e06632e00cbcf3909815d0d03d}{energy\_bp}})}
\DoxyCodeLine{00331\ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ad139b8e06632e00cbcf3909815d0d03d}{energy\_bp}}[ij];}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}})}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (u1\ +\ u2\ ==\ 0)\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a\ =\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[i]}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[p]}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[q]}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[j];}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ energy\ +=\ a;}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_a16a4e6c60a18917e0f1f94c1f2670c0a}{f}})}
\DoxyCodeLine{00343\ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a16a4e6c60a18917e0f1f94c1f2670c0a}{f}}(i,\ j,\ p,\ q,\ \mbox{\hyperlink{group__constraints_gaeab04f34d7730cff2d651d782f95d857}{VRNA\_DECOMP\_PAIR\_IL}},\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a7574680143df97b9029146c2150bf06d}{data}});}
\DoxyCodeLine{00344\ \ \ \}}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \textcolor{keywordflow}{return}\ energy;}
\DoxyCodeLine{00347\ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ PRIVATE\ INLINE\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00351\ ubf\_eval\_int\_loop2(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ j,}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ p,}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ q,}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ i1,}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ j1,}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ p1,}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ q1,}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ si,}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ sj,}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ sp,}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ sq,}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \ type,}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \ type\_2,}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ *rtype,}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ ij,}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \ \ *sn,}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \ \ *ss,}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}\ \ \ *P,}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__soft__constraints_structvrna__sc__s}{vrna\_sc\_t}}\ \ \ \ \ \ *sc)}
\DoxyCodeLine{00371\ \{}
\DoxyCodeLine{00372\ \ \ \textcolor{keywordtype}{int}\ energy,\ u1,\ u2;}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ u1\ \ =\ p1\ -\/\ i;}
\DoxyCodeLine{00375\ \ \ u2\ \ =\ j1\ -\/\ q;}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \textcolor{keywordflow}{if}\ ((sn[i]\ ==\ sn[p])\ \&\&\ (sn[q]\ ==\ sn[j]))\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{comment}{/*\ regular\ interior\ loop\ */}}
\DoxyCodeLine{00379\ \ \ \ \ energy\ =\ \mbox{\hyperlink{group__eval__deprecated_gaafbc187b7f78e8e82afb77dd6f3b8fc5}{E\_IntLoop}}(u1,\ u2,\ type,\ type\_2,\ si,\ sj,\ sp,\ sq,\ P);}
\DoxyCodeLine{00380\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{comment}{/*\ interior\ loop\ like\ cofold\ structure\ */}}
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{keywordtype}{short}\ Si,\ Sj;}
\DoxyCodeLine{00383\ \ \ \ \ Si\ \ \ \ \ \ =\ (sn[i1]\ ==\ sn[i])\ ?\ si\ :\ -\/1;}
\DoxyCodeLine{00384\ \ \ \ \ Sj\ \ \ \ \ \ =\ (sn[j]\ ==\ sn[j1])\ ?\ sj\ :\ -\/1;}
\DoxyCodeLine{00385\ \ \ \ \ energy\ \ =\ E\_IntLoop\_Co(rtype[type],\ rtype[type\_2],}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,\ j,\ p,\ q,}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ss[1],}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Si,\ Sj,}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sp,\ sq,}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_adcda4ff2ea77748ae0e8700288282efc}{dangles}},}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P);}
\DoxyCodeLine{00392\ \ \ \}}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \textcolor{comment}{/*\ add\ soft\ constraints\ */}}
\DoxyCodeLine{00395\ \ \ \textcolor{keywordflow}{if}\ (sc)\ \{}
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}})}
\DoxyCodeLine{00397\ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}}[i1][u1]}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}}[q1][u2];}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_ad139b8e06632e00cbcf3909815d0d03d}{energy\_bp}})}
\DoxyCodeLine{00401\ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ad139b8e06632e00cbcf3909815d0d03d}{energy\_bp}}[ij];}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}})}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (u1\ +\ u2\ ==\ 0)\ \{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a\ =\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[i]}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[p]}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[q]}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[j];}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ energy\ +=\ a;}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_a16a4e6c60a18917e0f1f94c1f2670c0a}{f}})}
\DoxyCodeLine{00413\ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a16a4e6c60a18917e0f1f94c1f2670c0a}{f}}(i,\ j,\ p,\ q,\ \mbox{\hyperlink{group__constraints_gaeab04f34d7730cff2d651d782f95d857}{VRNA\_DECOMP\_PAIR\_IL}},\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a7574680143df97b9029146c2150bf06d}{data}});}
\DoxyCodeLine{00414\ \ \ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \textcolor{keywordflow}{return}\ energy;}
\DoxyCodeLine{00417\ \}}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \textcolor{comment}{/*}}
\DoxyCodeLine{00421\ \textcolor{comment}{\ *\ \ ugly\ but\ fast\ exterior\ interior\ loop\ evaluation}}
\DoxyCodeLine{00422\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00423\ \textcolor{comment}{\ *\ \ Avoid\ including\ this\ function\ in\ your\ own\ code.\ It\ only\ serves}}
\DoxyCodeLine{00424\ \textcolor{comment}{\ *\ \ as\ a\ fast\ inline\ block\ internally\ re-\/used\ throughout\ the\ RNAlib.\ It}}
\DoxyCodeLine{00425\ \textcolor{comment}{\ *\ \ evalutes\ the\ free\ energy\ of\ interior\ loops\ in\ single\ sequences\ or\ sequence}}
\DoxyCodeLine{00426\ \textcolor{comment}{\ *\ \ hybrids.\ Soft\ constraints\ are\ also\ applied\ if\ available.}}
\DoxyCodeLine{00427\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00428\ \textcolor{comment}{\ *\ \ NOTE:\ do\ not\ include\ into\ doxygen\ reference\ manual!}}
\DoxyCodeLine{00429\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00430\ PRIVATE\ INLINE\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00431\ ubf\_eval\_ext\_int\_loop(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ j,}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ p,}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ q,}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ i1,}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ j1,}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ p1,}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ q1,}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ si,}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sj,}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sp,}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ sq,}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ type,}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ type\_2,}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ length,}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}\ \ *P,}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__soft__constraints_structvrna__sc__s}{vrna\_sc\_t}}\ \ \ \ \ *sc)}
\DoxyCodeLine{00448\ \{}
\DoxyCodeLine{00449\ \ \ \textcolor{keywordtype}{int}\ energy,\ u1,\ u2,\ u3;}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ \ \ u1\ \ =\ i1;}
\DoxyCodeLine{00452\ \ \ u2\ \ =\ p1\ -\/\ j;}
\DoxyCodeLine{00453\ \ \ u3\ \ =\ length\ -\/\ q;}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ energy\ =\ \mbox{\hyperlink{group__eval__deprecated_gaafbc187b7f78e8e82afb77dd6f3b8fc5}{E\_IntLoop}}(u2,\ u1\ +\ u3,\ type,\ type\_2,\ si,\ sj,\ sp,\ sq,\ P);}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \textcolor{comment}{/*\ add\ soft\ constraints\ */}}
\DoxyCodeLine{00458\ \ \ \textcolor{keywordflow}{if}\ (sc)\ \{}
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}})\ \{}
\DoxyCodeLine{00460\ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}}[j1][u2]}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ ((u3\ >\ 0)\ ?\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}}[q1][u3]\ :\ 0)}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ ((u1\ >\ 0)\ ?\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a57e4dbb924ab11f304e3762a3a9b07a1}{energy\_up}}[1][u1]\ :\ 0);}
\DoxyCodeLine{00463\ \ \ \ \ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}})}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (u1\ +\ u2\ +\ u3\ ==\ 0)}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[i]}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[p]}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[q]}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ sc-\/>\mbox{\hyperlink{group__soft__constraints_ac20dded6068e81acd0f1139092f66a22}{energy\_stack}}[j];}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>\mbox{\hyperlink{group__soft__constraints_a16a4e6c60a18917e0f1f94c1f2670c0a}{f}})}
\DoxyCodeLine{00473\ \ \ \ \ \ \ energy\ +=\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a16a4e6c60a18917e0f1f94c1f2670c0a}{f}}(i,\ j,\ p,\ q,\ \mbox{\hyperlink{group__constraints_gaeab04f34d7730cff2d651d782f95d857}{VRNA\_DECOMP\_PAIR\_IL}},\ sc-\/>\mbox{\hyperlink{group__soft__constraints_a7574680143df97b9029146c2150bf06d}{data}});}
\DoxyCodeLine{00474\ \ \ \}}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{return}\ energy;}
\DoxyCodeLine{00477\ \}}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ PRIVATE\ INLINE\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00481\ \mbox{\hyperlink{group__eval__deprecated_gaafbc187b7f78e8e82afb77dd6f3b8fc5}{E\_IntLoop}}(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ n1,}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ n2,}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ type,}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ type\_2,}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ si1,}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ sj1,}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ sp1,}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ sq1,}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}\ \ *P)}
\DoxyCodeLine{00490\ \{}
\DoxyCodeLine{00491\ \ \ \textcolor{comment}{/*\ compute\ energy\ of\ degree\ 2\ loop\ (stack\ bulge\ or\ interior)\ */}}
\DoxyCodeLine{00492\ \ \ \textcolor{keywordtype}{int}\ nl,\ ns,\ u,\ energy,\ salt\_stack\_correction,\ salt\_loop\_correction,\ backbones;}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ salt\_stack\_correction\ =\ P-\/>SaltStack;}
\DoxyCodeLine{00495\ \ \ salt\_loop\_correction\ =\ 0;}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{if}\ (n1\ >\ n2)\ \{}
\DoxyCodeLine{00498\ \ \ \ \ nl\ \ =\ n1;}
\DoxyCodeLine{00499\ \ \ \ \ ns\ \ =\ n2;}
\DoxyCodeLine{00500\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00501\ \ \ \ \ nl\ \ =\ n2;}
\DoxyCodeLine{00502\ \ \ \ \ ns\ \ =\ n1;}
\DoxyCodeLine{00503\ \ \ \}}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \textcolor{keywordflow}{if}\ (nl\ ==\ 0)\ \{}
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{keywordflow}{return}\ P-\/>stack[type][type\_2]\ +\ salt\_stack\_correction;\ \ \textcolor{comment}{/*\ stack\ */}}
\DoxyCodeLine{00507\ \ \ \}}
\DoxyCodeLine{00508\ \ \ }
\DoxyCodeLine{00509\ \ \ backbones\ =\ nl+ns+2;}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ \textcolor{keywordflow}{if}\ (P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_a66193a872ba929c87915bcd6d7e540d2}{salt}}\ !=\ \mbox{\hyperlink{group__model__details_gaa68703da9ccc5ae6da508bfda36b533f}{VRNA\_MODEL\_DEFAULT\_SALT}})\ \{}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{comment}{/*\ salt\ correction\ for\ loop\ */}}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordflow}{if}\ (backbones\ <=\ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}}+1)}
\DoxyCodeLine{00514\ \ \ \ \ \ \ salt\_loop\_correction\ =\ P-\/>SaltLoop[backbones];}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00516\ \ \ \ \ \ \ salt\_loop\_correction\ =\ \mbox{\hyperlink{group__energy__parameters_ga8368ed4693a396299f3d6c96b3083b20}{vrna\_salt\_loop\_int}}(backbones,\ P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_a66193a872ba929c87915bcd6d7e540d2}{salt}},\ P-\/>\mbox{\hyperlink{group__energy__parameters_aeed2cd83713012bcb52e431041e037c8}{temperature}}+K0);}
\DoxyCodeLine{00517\ \ \ \}}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \textcolor{keywordflow}{if}\ (ns\ ==\ 0)\ \{}
\DoxyCodeLine{00520\ \ \ \ \ \textcolor{comment}{/*\ bulge\ */}}
\DoxyCodeLine{00521\ \ \ \ \ energy\ =\ (nl\ <=\ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})\ ?\ P-\/>bulge[nl]\ :}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ (P-\/>bulge[30]\ +\ (\textcolor{keywordtype}{int})(P-\/>lxc\ *\ log(nl\ /\ 30.)));}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keywordflow}{if}\ (nl\ ==\ 1)\ \{}
\DoxyCodeLine{00524\ \ \ \ \ \ \ energy\ +=\ P-\/>stack[type][type\_2];}
\DoxyCodeLine{00525\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ >\ 2)}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ energy\ +=\ P-\/>TerminalAU;}
\DoxyCodeLine{00528\ }
\DoxyCodeLine{00529\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type\_2\ >\ 2)}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ energy\ +=\ P-\/>TerminalAU;}
\DoxyCodeLine{00531\ \ \ \ \ \}}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{keywordflow}{return}\ energy\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00534\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{comment}{/*\ interior\ loop\ */}}
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{keywordflow}{if}\ (ns\ ==\ 1)\ \{}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nl\ ==\ 1)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 1x1\ loop\ */}}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ P-\/>int11[type][type\_2][si1][sj1]\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nl\ ==\ 2)\ \{}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 2x1\ loop\ */}}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (n1\ ==\ 1)}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ energy\ =\ P-\/>int21[type][type\_2][si1][sq1][sj1];}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \ \ energy\ =\ P-\/>int21[type\_2][type][sq1][si1][sp1];}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ energy\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 1xn\ loop\ */}}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ energy\ =}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ (nl\ +\ 1\ <=}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})\ ?\ (P-\/>internal\_loop[nl\ +\ 1])\ :\ (P-\/>internal\_loop[30]\ +}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (int)(P-\/>lxc\ *\ log((nl\ +\ 1)\ /\ 30.)));}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ energy\ \ +=\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(MAX\_NINIO,\ (nl\ -\/\ ns)\ *\ P-\/>ninio[2]);}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ energy\ \ +=\ P-\/>mismatch1nI[type][si1][sj1]\ +\ P-\/>mismatch1nI[type\_2][sq1][sp1];}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ energy\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00558\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ns\ ==\ 2)\ \{}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nl\ ==\ 2)\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 2x2\ loop\ */}}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ P-\/>int22[type][type\_2][si1][sp1][sq1][sj1]\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (nl\ ==\ 3)\ \{}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 2x3\ loop\ */}}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ energy\ \ =\ P-\/>internal\_loop[5]\ +\ P-\/>ninio[2];}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ energy\ \ +=\ P-\/>mismatch23I[type][si1][sj1]\ +\ P-\/>mismatch23I[type\_2][sq1][sp1];}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ energy\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00568\ \ \ \ \ \}}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \ \ \{}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \textcolor{comment}{/*\ generic\ interior\ loop\ (no\ else\ here!)*/}}
\DoxyCodeLine{00572\ \ \ \ \ \ \ u\ \ \ \ \ \ \ =\ nl\ +\ ns;}
\DoxyCodeLine{00573\ \ \ \ \ \ \ energy\ \ =}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ (u\ <=}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}})\ ?\ (P-\/>internal\_loop[u])\ :\ (P-\/>internal\_loop[30]\ +\ (int)(P-\/>lxc\ *\ log((u)\ /\ 30.)));}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ \ \ \ \ energy\ +=\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(MAX\_NINIO,\ (nl\ -\/\ ns)\ *\ P-\/>ninio[2]);}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \ \ \ \ energy\ +=\ P-\/>mismatchI[type][si1][sj1]\ +\ P-\/>mismatchI[type\_2][sq1][sp1];}
\DoxyCodeLine{00580\ \ \ \ \ \}}
\DoxyCodeLine{00581\ \ \ \}}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \textcolor{keywordflow}{return}\ energy\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00584\ \}}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00586\ }
\DoxyCodeLine{00587\ PRIVATE\ INLINE\ \mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}}}
\DoxyCodeLine{00588\ \mbox{\hyperlink{group__eval__deprecated_ga95de54d8a2a17645a95e0f34e189d9c9}{exp\_E\_IntLoop}}(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u1,}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u2,}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ type,}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ type2,}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ \ \ \ si1,}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ \ \ \ sj1,}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ \ \ \ sp1,}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ \ \ \ \ \ sq1,}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t}}\ \ *P)}
\DoxyCodeLine{00597\ \{}
\DoxyCodeLine{00598\ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ ul,\ us,\ no\_close\ =\ 0;}
\DoxyCodeLine{00599\ \ \ \textcolor{keywordtype}{double}\ \ z\ \ \ \ \ \ \ \ \ \ \ =\ 0.;}
\DoxyCodeLine{00600\ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ noGUclosure\ =\ P-\/>\mbox{\hyperlink{group__energy__parameters_ac18055127bccc27c1223f1d2f3b01b53}{model\_details}}.\mbox{\hyperlink{group__model__details_a7e883db1f33f8f3baa5c9b140350c78e}{noGUclosure}};}
\DoxyCodeLine{00601\ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ backbones;}
\DoxyCodeLine{00602\ \ \ \textcolor{keywordtype}{double}\ \ salt\_stack\_correction\ =\ P-\/>expSaltStack;}
\DoxyCodeLine{00603\ \ \ \textcolor{keywordtype}{double}\ \ salt\_loop\_correction\ =\ 1.;}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \ \ \textcolor{keywordflow}{if}\ ((noGUclosure)\ \&\&\ ((type2\ ==\ 3)\ ||\ (type2\ ==\ 4)\ ||\ (type\ ==\ 3)\ ||\ (type\ ==\ 4)))}
\DoxyCodeLine{00606\ \ \ \ \ no\_close\ =\ 1;}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \textcolor{keywordflow}{if}\ (u1\ >\ u2)\ \{}
\DoxyCodeLine{00609\ \ \ \ \ ul\ \ =\ u1;}
\DoxyCodeLine{00610\ \ \ \ \ us\ \ =\ u2;}
\DoxyCodeLine{00611\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00612\ \ \ \ \ ul\ \ =\ u2;}
\DoxyCodeLine{00613\ \ \ \ \ us\ \ =\ u1;}
\DoxyCodeLine{00614\ \ \ \}}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \textcolor{comment}{/*\ salt\ correction\ for\ loop\ */}}
\DoxyCodeLine{00617\ \ \ backbones\ =\ ul+us+2;}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \textcolor{keywordflow}{if}\ (P-\/>\mbox{\hyperlink{group__energy__parameters_ac18055127bccc27c1223f1d2f3b01b53}{model\_details}}.\mbox{\hyperlink{group__model__details_a66193a872ba929c87915bcd6d7e540d2}{salt}}\ !=\ \mbox{\hyperlink{group__model__details_gaa68703da9ccc5ae6da508bfda36b533f}{VRNA\_MODEL\_DEFAULT\_SALT}})\ \{}
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{keywordflow}{if}\ (backbones\ <=\ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}}+1)}
\DoxyCodeLine{00621\ \ \ \ \ \ \ salt\_loop\_correction\ =\ P-\/>expSaltLoop[backbones];}
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00623\ \ \ \ \ \ \ salt\_loop\_correction\ =\ exp(-\/\mbox{\hyperlink{group__energy__parameters_ga8368ed4693a396299f3d6c96b3083b20}{vrna\_salt\_loop\_int}}(backbones,\ P-\/>\mbox{\hyperlink{group__energy__parameters_ac18055127bccc27c1223f1d2f3b01b53}{model\_details}}.\mbox{\hyperlink{group__model__details_a66193a872ba929c87915bcd6d7e540d2}{salt}},\ P-\/>\mbox{\hyperlink{group__energy__parameters_a674656d65ea957ddbeff8bd146b7fc16}{temperature}}+K0)\ *\ 10.\ /\ P-\/>kT);}
\DoxyCodeLine{00624\ \ \ \}}
\DoxyCodeLine{00625\ }
\DoxyCodeLine{00626\ \ \ \textcolor{keywordflow}{if}\ (ul\ ==\ 0)\ \{}
\DoxyCodeLine{00627\ \ \ \ \ \textcolor{comment}{/*\ stack\ */}}
\DoxyCodeLine{00628\ \ \ \ \ z\ =\ P-\/>expstack[type][type2]\ *\ salt\_stack\_correction;}
\DoxyCodeLine{00629\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!no\_close)\ \{}
\DoxyCodeLine{00630\ \ \ \ \ \textcolor{keywordflow}{if}\ (us\ ==\ 0)\ \{}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \textcolor{comment}{/*\ bulge\ */}}
\DoxyCodeLine{00632\ \ \ \ \ \ \ z\ =\ P-\/>expbulge[ul];}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ul\ ==\ 1)\ \{}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ z\ *=\ P-\/>expstack[type][type2];}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ >\ 2)}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ z\ *=\ P-\/>expTermAU;}
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type2\ >\ 2)}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ z\ *=\ P-\/>expTermAU;}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})(z\ *\ salt\_loop\_correction);}
\DoxyCodeLine{00644\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (us\ ==\ 1)\ \{}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ul\ ==\ 1)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 1x1\ loop\ */}}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})(P-\/>expint11[type][type2][si1][sj1]\ *\ salt\_loop\_correction);}
\DoxyCodeLine{00647\ }
\DoxyCodeLine{00648\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ul\ ==\ 2)\ \{}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 2x1\ loop\ */}}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (u1\ ==\ 1)}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})(P-\/>expint21[type][type2][si1][sq1][sj1]\ *\ salt\_loop\_correction);}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})(P-\/>expint21[type2][type][sq1][si1][sp1]\ *\ salt\_loop\_correction);}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 1xn\ loop\ */}}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ z\ =\ P-\/>expinternal[ul\ +\ us]\ *\ P-\/>expmismatch1nI[type][si1][sj1]\ *}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ P-\/>expmismatch1nI[type2][sq1][sp1];}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})(z\ *\ P-\/>expninio[2][ul\ -\/\ us]\ *\ salt\_loop\_correction);}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00660\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (us\ ==\ 2)\ \{}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ul\ ==\ 2)\ \{}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 2x2\ loop\ */}}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})(P-\/>expint22[type][type2][si1][sp1][sq1][sj1]\ *\ salt\_loop\_correction);}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ul\ ==\ 3)\ \{}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 2x3\ loop\ */}}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ z\ =\ P-\/>expinternal[5]\ *\ P-\/>expmismatch23I[type][si1][sj1]\ *}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ P-\/>expmismatch23I[type2][sq1][sp1];}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})(z\ *\ P-\/>expninio[2][1]\ *\ salt\_loop\_correction);}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00670\ \ \ \ \ \}}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{comment}{/*\ generic\ interior\ loop\ (no\ else\ here!)*/}}
\DoxyCodeLine{00673\ \ \ \ \ z\ =\ P-\/>expinternal[ul\ +\ us]\ *\ P-\/>expmismatchI[type][si1][sj1]\ *}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ P-\/>expmismatchI[type2][sq1][sp1];}
\DoxyCodeLine{00675\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})(z\ *\ P-\/>expninio[2][ul\ -\/\ us]\ *\ salt\_loop\_correction);}
\DoxyCodeLine{00676\ \ \ \}}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}})z;}
\DoxyCodeLine{00679\ \}}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ }
\DoxyCodeLine{00682\ PRIVATE\ INLINE\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00683\ E\_IntLoop\_Co(\textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ type,}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ type\_2,}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ i,}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ j,}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ p,}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ q,}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ cutpoint,}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ si1,}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ sj1,}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ sp1,}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \ \ \ \ \ \ \ sq1,}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}},}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}}\ *P)}
\DoxyCodeLine{00696\ \{}
\DoxyCodeLine{00697\ \ \ \textcolor{keywordtype}{int}\ e,\ energy,\ ci,\ cj,\ cp,\ cq,\ d3,\ d5,\ d5\_2,\ d3\_2,\ tmm,\ tmm\_2;}
\DoxyCodeLine{00698\ \ \ \textcolor{keywordtype}{int}\ salt\_loop\_correction,\ backbones;}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \ \ salt\_loop\_correction\ =\ 0;}
\DoxyCodeLine{00701\ }
\DoxyCodeLine{00702\ \ \ backbones\ =\ p\ -\/\ i\ +\ j\ -\/\ q;}
\DoxyCodeLine{00703\ \ \ \textcolor{comment}{/*\ salt\ correction\ for\ loop\ */}}
\DoxyCodeLine{00704\ \ \ \textcolor{keywordflow}{if}\ (P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_a66193a872ba929c87915bcd6d7e540d2}{salt}}\ !=\ \mbox{\hyperlink{group__model__details_gaa68703da9ccc5ae6da508bfda36b533f}{VRNA\_MODEL\_DEFAULT\_SALT}})\ \{}
\DoxyCodeLine{00705\ \ \ \ \ \textcolor{keywordflow}{if}\ (backbones\ <=\ \mbox{\hyperlink{constants_8h_ad1bd6eabac419670ddd3c9ed82145988}{MAXLOOP}}+1)}
\DoxyCodeLine{00706\ \ \ \ \ \ \ salt\_loop\_correction\ =\ P-\/>SaltLoop[backbones];}
\DoxyCodeLine{00707\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00708\ \ \ \ \ \ \ salt\_loop\_correction\ =\ \mbox{\hyperlink{group__energy__parameters_ga8368ed4693a396299f3d6c96b3083b20}{vrna\_salt\_loop\_int}}(backbones,\ P-\/>\mbox{\hyperlink{group__energy__parameters_a7b84353eb9075c595bad4ceb871bcae7}{model\_details}}.\mbox{\hyperlink{group__model__details_a66193a872ba929c87915bcd6d7e540d2}{salt}},\ P-\/>\mbox{\hyperlink{group__energy__parameters_aeed2cd83713012bcb52e431041e037c8}{temperature}}+K0);}
\DoxyCodeLine{00709\ \ \ \}}
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00711\ \ \ energy\ =\ 0;}
\DoxyCodeLine{00712\ \ \ \textcolor{keywordflow}{if}\ (type\ >\ 2)}
\DoxyCodeLine{00713\ \ \ \ \ energy\ +=\ P-\/>TerminalAU;}
\DoxyCodeLine{00714\ }
\DoxyCodeLine{00715\ \ \ \textcolor{keywordflow}{if}\ (type\_2\ >\ 2)}
\DoxyCodeLine{00716\ \ \ \ \ energy\ +=\ P-\/>TerminalAU;}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}})}
\DoxyCodeLine{00719\ \ \ \ \ \textcolor{keywordflow}{return}\ energy\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ ci\ \ =\ ON\_SAME\_STRAND(i,\ i\ +\ 1,\ cutpoint);}
\DoxyCodeLine{00722\ \ \ cj\ \ =\ ON\_SAME\_STRAND(j\ -\/\ 1,\ j,\ cutpoint);}
\DoxyCodeLine{00723\ \ \ cp\ \ =\ ON\_SAME\_STRAND(p\ -\/\ 1,\ p,\ cutpoint);}
\DoxyCodeLine{00724\ \ \ cq\ \ =\ ON\_SAME\_STRAND(q,\ q\ +\ 1,\ cutpoint);}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \ \ d3\ \ \ \ =\ ci\ \ ?\ P-\/>dangle3[type][si1]\ \ \ :\ 0;}
\DoxyCodeLine{00727\ \ \ d5\ \ \ \ =\ cj\ \ ?\ P-\/>dangle5[type][sj1]\ \ \ :\ 0;}
\DoxyCodeLine{00728\ \ \ d5\_2\ \ =\ cp\ \ ?\ P-\/>dangle5[type\_2][sp1]\ :\ 0;}
\DoxyCodeLine{00729\ \ \ d3\_2\ \ =\ cq\ \ ?\ P-\/>dangle3[type\_2][sq1]\ :\ 0;}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ tmm\ \ \ =\ (cj\ \&\&\ ci)\ ?\ P-\/>mismatchExt[type][sj1][si1]\ \ \ :\ d5\ +\ d3;}
\DoxyCodeLine{00732\ \ \ tmm\_2\ =\ (cp\ \&\&\ cq)\ ?\ P-\/>mismatchExt[type\_2][sp1][sq1]\ :\ d5\_2\ +\ d3\_2;}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{group__model__details_ga72b511ed1201f7e23ec437e468790d74}{dangles}}\ ==\ 2)}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{keywordflow}{return}\ energy\ +\ tmm\ +\ tmm\_2\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \ \ \textcolor{comment}{/*\ now\ we\ may\ have\ non-\/double\ dangles\ only\ */}}
\DoxyCodeLine{00738\ \ \ \textcolor{keywordflow}{if}\ (p\ -\/\ i\ >\ 2)\ \{}
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ -\/\ q\ >\ 2)\ \{}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \textcolor{comment}{/*\ all\ degrees\ of\ freedom\ */}}
\DoxyCodeLine{00741\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(tmm,\ d5);}
\DoxyCodeLine{00742\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3);}
\DoxyCodeLine{00743\ \ \ \ \ \ \ energy\ +=\ e;}
\DoxyCodeLine{00744\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(tmm\_2,\ d5\_2);}
\DoxyCodeLine{00745\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3\_2);}
\DoxyCodeLine{00746\ \ \ \ \ \ \ energy\ +=\ e;}
\DoxyCodeLine{00747\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (j\ -\/\ q\ ==\ 2)\ \{}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \textcolor{comment}{/*\ all\ degrees\ of\ freedom\ in\ 5'\ part\ between\ i\ and\ p\ */}}
\DoxyCodeLine{00749\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(tmm\ +\ d5\_2,\ d3\ +\ d5\_2);}
\DoxyCodeLine{00750\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d5\ +\ d5\_2);}
\DoxyCodeLine{00751\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3\ +\ tmm\_2);}
\DoxyCodeLine{00752\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3\ +\ d3\_2);}
\DoxyCodeLine{00753\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ tmm\_2);\ \textcolor{comment}{/*\ no\ dangles\ on\ enclosing\ pair\ */}}
\DoxyCodeLine{00754\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d5\_2);\ \ \textcolor{comment}{/*\ no\ dangles\ on\ enclosing\ pair\ */}}
\DoxyCodeLine{00755\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3\_2);\ \ \textcolor{comment}{/*\ no\ dangles\ on\ enclosing\ pair\ */}}
\DoxyCodeLine{00756\ \ \ \ \ \ \ energy\ +=\ e;}
\DoxyCodeLine{00757\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \textcolor{comment}{/*\ no\ unpaired\ base\ between\ q\ and\ j\ */}}
\DoxyCodeLine{00759\ \ \ \ \ \ \ energy\ +=\ d3\ +\ d5\_2;}
\DoxyCodeLine{00760\ \ \ \ \ \}}
\DoxyCodeLine{00761\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (p\ -\/\ i\ ==\ 2)\ \{}
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ -\/\ q\ >\ 2)\ \{}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \textcolor{comment}{/*\ all\ degrees\ of\ freedom\ in\ 3'\ part\ between\ q\ and\ j\ */}}
\DoxyCodeLine{00764\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(tmm\ +\ d3\_2,\ d5\ +\ d3\_2);}
\DoxyCodeLine{00765\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d5\ +\ d3\_2);}
\DoxyCodeLine{00766\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3\ +\ d3\_2);}
\DoxyCodeLine{00767\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d5\ +\ tmm\_2);}
\DoxyCodeLine{00768\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ tmm\_2);}
\DoxyCodeLine{00769\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d5\_2);}
\DoxyCodeLine{00770\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3\_2);}
\DoxyCodeLine{00771\ \ \ \ \ \ \ energy\ +=\ e;}
\DoxyCodeLine{00772\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (j\ -\/\ q\ ==\ 2)\ \{}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \textcolor{comment}{/*\ one\ possible\ dangling\ base\ between\ either\ side\ */}}
\DoxyCodeLine{00774\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(tmm,\ tmm\_2);}
\DoxyCodeLine{00775\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3);}
\DoxyCodeLine{00776\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d5);}
\DoxyCodeLine{00777\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d5\_2);}
\DoxyCodeLine{00778\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3\_2);}
\DoxyCodeLine{00779\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d3\ +\ d3\_2);}
\DoxyCodeLine{00780\ \ \ \ \ \ \ e\ =\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(e,\ d5\ +\ d5\_2);}
\DoxyCodeLine{00781\ \ \ \ \ \ \ energy\ +=\ e;}
\DoxyCodeLine{00782\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \textcolor{comment}{/*\ one\ unpaired\ base\ between\ i\ and\ p\ */}}
\DoxyCodeLine{00784\ \ \ \ \ \ \ energy\ +=\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(d3,\ d5\_2);}
\DoxyCodeLine{00785\ \ \ \ \ \}}
\DoxyCodeLine{00786\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00787\ \ \ \ \ \textcolor{comment}{/*\ no\ unpaired\ base\ between\ i\ and\ p\ */}}
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ -\/\ q\ >\ 2)\ \{}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \textcolor{comment}{/*\ all\ degrees\ of\ freedom\ in\ 3'\ part\ between\ q\ and\ j\ */}}
\DoxyCodeLine{00790\ \ \ \ \ \ \ energy\ +=\ d5\ +\ d3\_2;}
\DoxyCodeLine{00791\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (j\ -\/\ q\ ==\ 2)\ \{}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \textcolor{comment}{/*\ one\ unpaired\ base\ between\ q\ and\ j\ */}}
\DoxyCodeLine{00793\ \ \ \ \ \ \ energy\ +=\ \mbox{\hyperlink{group__utils_gae0b9cd0ce090bd69b951aa73e8fa4f7d}{MIN2}}(d5,\ d3\_2);}
\DoxyCodeLine{00794\ \ \ \ \ \}}
\DoxyCodeLine{00795\ \ \ \}}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \ \ \textcolor{keywordflow}{return}\ energy\ +\ salt\_loop\_correction;}
\DoxyCodeLine{00798\ \}}
\DoxyCodeLine{00799\ }
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00805\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
